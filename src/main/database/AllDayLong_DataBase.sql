-- ALLDAYLONG_PROTOTYPE 
--Version 22.03.15
-- 계열사
CREATE TABLE AFFILIATE(
AF_ID NUMBER(10) NOT NULL PRIMARY KEY,
AF_NAME VARCHAR2(50) NOT NULL
);


-- 손님
CREATE TABLE CUSTOMER (
CU_NO VARCHAR2(50) NOT NULL PRIMARY KEY,
CU_ID VARCHAR2(50) UNIQUE NOT NULL,
CU_PW VARCHAR2(50) NOT NULL,
CU_NAME VARCHAR2(20) NOT NULL,
CU_PHONE CHAR(11) UNIQUE NOT NULL,
CU_MAIL VARCHAR2(100) UNIQUE NOT NULL,
CU_SEX CHAR(2) NOT NULL, 
CHECK (CU_SEX IN ('M','F')) 
);

-- 호텔
CREATE TABLE HOTEL (
HO_ID NUMBER(10) NOT NULL PRIMARY KEY,
HO_NAME VARCHAR2(50) NOT NULL,
HO_GRADE NUMBER(2) NOT NULL,
HO_LOC VARCHAR2(500) NOT NULL,
HO_ACTIVITY VARCHAR2(500),
AF_ID NUMBER(10)
);

-- 리뷰
CREATE TABLE REVIEW (
REVIEW_ID NUMBER(10) NOT NULL PRIMARY KEY,
REVIEW_TITLE VARCHAR2(50) DEFAULT 'NONE',
REVIEW_DATE DATE DEFAULT SYSDATE,
REVIEW_CONTENTS VARCHAR2(1000),
CU_NO VARCHAR2(50),
HO_ID NUMBER(10)
);

-- 즐길거리
CREATE TABLE ENJOYS (
EN_ID NUMBER(10) NOT NULL PRIMARY KEY,
EN_CONTENTS VARCHAR2(400)
);

-- 호텔즐길거리
CREATE TABLE ENJOYS_X_HOTEL (
EN_ID NUMBER(10),
HO_ID NUMBER(10),
CONSTRAINT ENJOYS_X_HOTEL_PK PRIMARY KEY(EN_ID, HO_ID)
);

-- 멤버쉽
CREATE TABLE MEMBERSHIP (
CU_NO VARCHAR2(50),
HO_ID NUMBER(10),
MEM_NAME VARCHAR2(50),
MEM_GRADE VARCHAR2(20),
MEM_POINT NUMBER(10),
MEM_RDATE DATE DEFAULT SYSDATE,
AF_ID NUMBER(10),

CONSTRAINT MEMBERSHIP_PK PRIMARY KEY(CU_NO, HO_ID)
);

-- 이벤트
CREATE TABLE EVENT (
EV_ID NUMBER(10) NOT NULL PRIMARY KEY,
EV_NAME VARCHAR2(20) DEFAULT 'NONE',
EV_PRICE NUMBER(10),
HO_ID NUMBER(10)
);






-- FK 제약조건
--HOTEL
ALTER TABLE HOTEL ADD CONSTRAINT HOTEL_PK FOREIGN KEY(AF_ID) REFERENCES AFFILIATE(AF_ID) ON DELETE CASCADE;


-- REVIEW TABLE FK
ALTER TABLE REVIEW ADD CONSTRAINT REVIEW_CU_NO_PK FOREIGN KEY(CU_NO) REFERENCES CUSTOMER(CU_NO) ON DELETE CASCADE;
ALTER TABLE REVIEW ADD CONSTRAINT REVIEW_HO_ID_PK FOREIGN KEY(HO_ID) REFERENCES HOTEL(HO_ID) ON DELETE CASCADE;

-- ENJOYS_X_HOTEL FK
ALTER TABLE ENJOYS_X_HOTEL ADD CONSTRAINT ENJOYS_X_HOTEL_EN_ID_PK FOREIGN KEY(EN_ID) REFERENCES ENJOYS(EN_ID) ON DELETE CASCADE;
ALTER TABLE ENJOYS_X_HOTEL ADD CONSTRAINT ENJOYS_X_HOTEL_HO_ID_PK FOREIGN KEY(HO_ID) REFERENCES HOTEL(HO_ID) ON DELETE CASCADE;

--MEMBERSHIP FK
ALTER TABLE MEMBERSHIP ADD CONSTRAINT MEMBERSHIP_CU_NO_PK FOREIGN KEY(CU_NO) REFERENCES CUSTOMER(CU_NO) ON DELETE CASCADE;
ALTER TABLE MEMBERSHIP ADD CONSTRAINT MEMBERSHIP_HO_ID_PK FOREIGN KEY(HO_ID) REFERENCES HOTEL(HO_ID) ON DELETE CASCADE;
ALTER TABLE MEMBERSHIP ADD CONSTRAINT MEMBERSHIP_AF_ID_PK FOREIGN KEY(AF_ID) REFERENCES AFFILIATE(AF_ID) ON DELETE CASCADE;

--EVENT
ALTER TABLE EVENT ADD CONSTRAINT EVENT_PK FOREIGN KEY(HO_ID) REFERENCES HOTEL(HO_ID) ON DELETE CASCADE;




-- 테스트 데이터


INSERT INTO AFFILIATE VALUES ('1', '대박계열사');
INSERT INTO AFFILIATE VALUES ('2', '쪽박계열사');
INSERT INTO AFFILIATE VALUES ('3', '엄청난계열사');


INSERT INTO CUSTOMER VALUES ('CUNO1', 'testid1', 'testpw1', 'name1', '01000000000', 'test1@test.com','M');
INSERT INTO CUSTOMER VALUES ('CUNO2', 'testid2', 'testpw2', 'name2', '01000000001', 'test2@test.com','F');
INSERT INTO CUSTOMER VALUES ('CUNO3', 'testid3', 'testpw3', 'name3', '01000000002', 'test3@test.com','M');
INSERT INTO CUSTOMER VALUES ('CUNO4', 'testid4', 'testpw4', 'name4', '01000000003', 'test4@test.com','F');
INSERT INTO CUSTOMER VALUES ('CUNO5', 'testid5', 'testpw5', 'name5', '01000000004', 'test5@test.com','M');



INSERT INTO HOTEL VALUES ('1', 'HOTEL NAME#1', '1', '경기도 수원시 영통구 광교산로 154-42', '뭐든지', '1');
INSERT INTO HOTEL VALUES ('2', 'HOTEL NAME#2', '2', '경기도 수원시 영통구 광교산로 154-42', '다있습니다', '2');
INSERT INTO HOTEL VALUES ('3', 'HOTEL NAME#3', '3', '서울특별시 서대문구 경기대로9길 24', '아님말고', '3');

INSERT INTO REVIEW(REVIEW_ID, REVIEW_TITLE, REVIEW_CONTENTS, CU_NO, HO_ID) VALUES ('1', 'REVIEW NAME#1', '대충리뷰내용#1', 'CUNO1', '1');
INSERT INTO REVIEW(REVIEW_ID, REVIEW_TITLE, REVIEW_CONTENTS, CU_NO, HO_ID) VALUES ('2', 'REVIEW NAME#2', '대충리뷰내용#2', 'CUNO2', '2');
INSERT INTO REVIEW(REVIEW_ID, REVIEW_TITLE, REVIEW_CONTENTS, CU_NO, HO_ID) VALUES ('3', 'REVIEW NAME#3', '대충리뷰내용#3', 'CUNO3', '3');

INSERT INTO ENJOYS VALUES ('1', '뭔가 있습니다.');
INSERT INTO ENJOYS VALUES ('2', '비밀이야');
INSERT INTO ENJOYS VALUES ('3', '안알랴줌');

INSERT INTO MEMBERSHIP(CU_NO, HO_ID, MEM_NAME, MEM_GRADE, MEM_POINT, AF_ID) VALUES ('CUNO1', '1', '대박멤버쉽', 'KING', '123456','1');
INSERT INTO MEMBERSHIP(CU_NO, HO_ID, MEM_NAME, MEM_GRADE, MEM_POINT, AF_ID) VALUES ('CUNO2', '2', '몰라멤버쉽', 'QUEEN', '111111','2');
INSERT INTO MEMBERSHIP(CU_NO, HO_ID, MEM_NAME, MEM_GRADE, MEM_POINT, AF_ID) VALUES ('CUNO3', '3', '어쩌구멤버쉽', 'QUEEN', '122222','3');

INSERT INTO EVENT VALUES ('1', '대박이벤트1', '50000', '1');
INSERT INTO EVENT VALUES ('2', '대박이벤트2', '40000', '2');
INSERT INTO EVENT VALUES ('3', '대박이벤트3', '30000', '3');
